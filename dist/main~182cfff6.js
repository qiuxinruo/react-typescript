!function(e){function t(t){for(var r,i,c=t[0],l=t[1],d=t[2],s=0,f=[];s<c.length;s++)i=c[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(u&&u(t);f.length;)f.shift()();return o.push.apply(o,d||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var l=n[c];0!==a[l]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={0:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var u=l;o.push(["7WaW",1,4,2,3,5,6]),n()}({"4/dB":function(e,t,n){var r=n("+5m6"),a=n("ryuo");"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:"head",singleton:!1};r(a,o);e.exports=a.locals||{}},"7WaW":function(e,t,n){"use strict";n.r(t);var r=n("zBai"),a=n("ZZRV"),o=n.n(a),i=n("aaDO"),c=n("DndG"),l=n("CDvi"),d=n("EaaV"),u=(n("LdKk"),n("iE79"),n("r+ny"),n("94H+"),n("q5+0")),s=n("vPxn"),f=n("uV/z"),b=n("eSV8"),p=n("WXbK");function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=n.n(p).a.create({withCredentials:!0,headers:{"Content-Type":"application/json;charset=UTF-8"}});v.interceptors.response.use((function(e){var t=e.data;return function(e,t){e.url;var n=e.checkRequestSuccess,r=t.success;t.retcode,t.status,t.code;return n&&"function"==typeof n?n({data:t}):!0===r}(e.config,t)?t:Promise.reject(t)}));var _=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v.get(e,y({params:t},n))},g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v.post(e,t,n)};v.request;function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){var n=Object(b.b)(),r={i:n,x:0,y:Object.keys(e.elements).length,w:12,h:12,minW:2,minH:2},a={id:n,type:t,name:"新的表格"};e.elements[n]=a,e.layouts.push(r)}function S(e,t){delete e.elements[t],e.layouts=e.layouts.filter((function(e){return e.i!==t}))}function x(e){return g("/bi-gateway/das/report/save",E({},e)).then((function(e){return e})).catch((function(e){return e}))}n("r4t0");var k=function(){return o.a.createElement("div",{className:"db_common_loading"},o.a.createElement("div",{className:"db_common_loading-wrap"},o.a.createElement("img",{src:"http://statics.jituancaiyun.net/config/loading.gif"})))};function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=s.a.TabPane,P=function(e){var t=Object(u.h)(),n=t.workbookId,r=t.dashboardId,c=Object(i.b)(),l=Object(u.g)(),d=I(Object(a.useState)([]),2),p=d[0],m=d[1],y=I(Object(a.useState)(!1),2),h=y[0],v=y[1];Object(a.useEffect)((function(){O()}),[]);var O=function(){var e;v(!0),(e={workBookId:n},_("/bi-gateway/das/report/queryList",E({},e)).then((function(e){return e})).catch((function(e){return e}))).then((function(e){v(!1),e.success&&(m(e.data),e.data.length&&(l.push("/dashboard/detail/".concat(n,"/").concat(e.data[0].reportId)),w(n,e.data[0].reportId)))})).catch((function(e){return console.log(e)}))},w=function(e,t){v(!0),function(e,t){return _("/bi-gateway/das/report/".concat(e,"/").concat(t,"/edit"),{}).then((function(e){return e})).catch((function(e){return e}))}(e,t).then((function(e){if(v(!1),e.success){var t=e.data,n=t.layouts?JSON.parse(t.layouts):[],r=t.elements?JSON.parse(t.elements):{};c({type:"INIT_STATE",payload:{layouts:n,elements:r,name:t.name}}),c({type:"DATASET_ID_CHANGE",payload:t.dataSetId}),c({type:"SAVE_DATASET_CUBE_NAME",payload:t.dataSetCubeName})}}))},j=function(){v(!0),x({workBookId:n,name:"新建报表",elements:"",layouts:""}).then((function(e){if(v(!1),e.success){var t=[{reportId:e.data,name:"新建报表"}];m(p.concat(t)),l.push("/dashboard/detail/".concat(n,"/").concat(e.data)),c({type:"CANVAS_MOUSE_DOWN"}),c({type:"INIT_STATE",payload:{name:"新建报表",layouts:[],elements:{}}})}})).catch((function(e){console.log(e)}))},S=function(e){var t;(t={reportId:e},g("/bi-gateway/das/report/delete",E({},t)).then((function(e){return e})).catch((function(e){return e}))).then((function(t){if(t.success){var r=Object(b.a)(p).filter((function(t,n){return t.reportId!=e})),a="";r.length?(a="".concat(n,"/").concat(r[0].reportId),w(n,r[0].reportId)):a="".concat(n),m(r),l.push("/dashboard/detail/".concat(a)),c({type:"CANVAS_MOUSE_DOWN"})}})).catch((function(e){console.log(e)}))};return o.a.createElement("header",{className:"db_detail_header"},o.a.createElement("div",{className:"db_detail_header-main"},o.a.createElement("div",null,o.a.createElement(f.a,{onClick:function(){l.push("/dashboard/workbook"),c({type:"INIT_STATE",payload:{layouts:[],elements:{},name:""}})}}),o.a.createElement("span",{className:"db_detail_header-title"},"工作簿"))),o.a.createElement(s.a,{size:"small",type:"editable-card",onChange:function(e){return function(e){l.push("/dashboard/detail/".concat(n,"/").concat(e)),w(n,e),c({type:"CANVAS_MOUSE_DOWN"})}(e)},activeKey:r,onEdit:function(e,t){return function(e,t){switch(t){case"add":j();break;case"remove":S(e)}}(e,t)}},(p||[]).map((function(e,t){return o.a.createElement(A,{key:e.reportId,tab:e.name})}))),h&&o.a.createElement(k,null))},C=n("IUJC"),D=[{icon:n("LNAl").a,type:"Table"}],T=function(){var e=Object(i.b)(),t=Object(u.h)(),n=(t.workbookId,t.dashboardId);return o.a.createElement("div",{className:"db_detail_toolbar"},D.map((function(t){return o.a.createElement("a",{className:"db_detail_toolbar-icon",key:t.type,onClick:function(){if(void 0===n)return C.b.warning("请先添加报表"),!1;e({type:"ADD_ELEMENT",payload:t.type})}},o.a.createElement(t.icon,null))})))},M=n("BX2d"),B=n("OBD+"),F=n("IbMA"),L=n("ys+E"),U=n("Al8J"),z=n("73mG"),H=n("DtKX"),J=n("v5EN"),W=n("QgdA"),V=n("oaOw");function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var G=function(e){var t=e.closeModal,n=q(Object(a.useState)(e.name),2),r=n[0],i=n[1];return o.a.createElement(W.a,{visible:!0,title:"重命名",onOk:function(){return t(r)},onCancel:function(){return t(!1)}},o.a.createElement(V.a,{value:r,onChange:function(e){return i(e.target.value)},placeholder:"请输入"}))},$=n("/tFb"),K=n.n($);function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Q=L.a.Item,Z=function(e){var t=e.data,n=e.children,r=t.id,c=Object(u.h)(),l=c.workbookId,d=c.dashboardId,s=X(Object(a.useState)(!1),2),f=s[0],p=s[1],m=Object(i.c)((function(e){return e})),y=m.dataSetId,h=m.elements,v=m.layouts,_=m.name,g=Object(i.b)(),O=function(){var e=Object(b.a)(t),n=e.dimensions,r=void 0===n?[]:n,a=e.measures,o=void 0===a?[]:a,i=e.filters,c=r.map((function(e){return delete e.alias,e})),l=o.map((function(e){return delete e.name,e})),d=c.concat(l).sort((function(e,t){return e.sortId-t.sortId}));console.log(d),function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"1";new Promise((function(a,o){var i=new XMLHttpRequest;i.open("POST",e),i.responseType="blob","1"===r?i.setRequestHeader("Content-Type","application/json"):i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onload=function(e){var t=this.response;if(200===this.status&&"application/json"!==t.type){var r=new Blob([t]);if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(r,n);else{var i=document.createElement("a");i.download=n,i.style.display="none",i.href=URL.createObjectURL(r),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i),i=null}a(e)}else{var c=new FileReader;c.onload=function(e){var t=Object(b.a)(e),n=JSON.parse(t.target.result);C.b.error(n.msg||n.error),o(n)},c.onerror=function(e){o(e)},c.readAsText(t)}},i.onerror=function(e){o(e)},"1"===r?i.send(JSON.stringify(t)):i.send(K.a.stringify(t))}))}("/bi-gateway/das/report/export",{type:"excel",chartId:t.id,dataSetId:y,fileName:t.name,chartType:"grid",filters:i.map((function(e){return delete e.alias,e})),columns:d.map((function(e){return delete e.sortId,e}))},t.name+".xlsx")},E=o.a.createElement(L.a,{className:"undraggable",onClick:function(e){var t=e.key;switch(e.domEvent.stopPropagation(),t){case"DELETE_ELEMENT":g({type:t,payload:r});break;case"export":O();break;case"rename":p(!0)}}},o.a.createElement(Q,{key:"rename"},o.a.createElement(U.a,null),o.a.createElement("span",null,"重命名")),o.a.createElement(Q,{key:"DELETE_ELEMENT"},o.a.createElement(z.a,null),o.a.createElement("span",null,"删除元素")),o.a.createElement(Q,{key:"export"},o.a.createElement(H.a,null),o.a.createElement("span",null,"导出数据")));return o.a.createElement("div",{className:"db_detail_container"},o.a.createElement("div",{className:"db_detail_container-header"},o.a.createElement("div",null,t.name),o.a.createElement(F.a,{className:"undraggable",overlay:E,trigger:["click"]},o.a.createElement("div",{className:"db_detail_container-more"},o.a.createElement(J.a,null)))),o.a.createElement("div",{className:"db_detail_container-content",onMouseDown:function(){g({type:"SELECT_ELEMENT",payload:r})}},n),f&&o.a.createElement(G,{name:t.name,closeModal:function(e){return function(e){var n=Object(b.a)(t);if(e){n.name=e;var r=Object(b.a)(h);r[t.id]=n,g({type:"INIT_STATE",payload:{layouts:v,elements:r,name:_}}),x({workBookId:l,reportId:d,name:_,layouts:JSON.stringify(v),elements:JSON.stringify(r)}).then((function(e){}))}p(!1)}(e)}}))};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oe=function(e){var t=e.data,n=Object(i.c)((function(e){return e})).dataSetId,r=re(Object(a.useState)([]),2),c=r[0],l=r[1],d=re(Object(a.useState)([]),2),u=d[0],s=d[1],f=re(Object(a.useState)(!1),2),p=f[0],m=f[1];console.log(n,"dataSetId"),Object(a.useEffect)((function(){y({})}),[t,n]);var y=function(e){var r=Object(b.a)(t),a=r.dimensions,o=void 0===a?[]:a,i=r.measures,c=void 0===i?[]:i,l=r.filters,d=void 0===l?[]:l,u=o.concat(c).sort((function(e,t){return e.sortId-t.sortId}));h(u),m(!0),function(e){return g("/bi-gateway/das/report/queryData",E({},e)).then((function(e){return e})).catch((function(e){return e}))}({chartType:"grid",dataSetId:n,orderInfo:e,dimensions:o.map((function(e){return delete e.sortId,e})),measures:c.map((function(e){return delete e.sortId,e})),filters:d.map((function(e){return e}))}).then((function(e){if(m(!1),e.success){var t=e.data.map((function(e,t){return te(te({},e),{},{itemId:t})}));s(t)}}))},h=function(e){var t=e.map((function(e){return{title:e.function?e.name:e.alias,key:e.columnName,dataIndex:e.columnName,sorter:!0}}));l(t)};return o.a.createElement(Z,{data:t},o.a.createElement(B.a,{loading:p,columns:c,dataSource:u,rowKey:function(e){return e.itemId},onChange:function(e,t,n){return function(e,t,n){console.log(e,t,n);var r=n.order?{columnName:n.field,orderParam:"ascend"==n.order?0:1}:{};y(r)}(e,t,n)}}))},ie=Object(M.WidthProvider)(M.Responsive),ce=function(){var e=Object(i.b)(),t=Object(u.h)(),n=t.workbookId,r=t.dashboardId,a=Object(i.c)((function(e){return e})),c=a.elements,l=a.layouts,d=a.selectId,s=a.name;return o.a.createElement("div",{id:"dashboard-content",className:"db_detail_content",onMouseDown:function(t){"dashboard-content"!==t.target.id&&"react-grid-layout"!==t.target.className||e({type:"CANVAS_MOUSE_DOWN"})}},o.a.createElement(ie,{layouts:{lg:l},breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},rowHeight:40,draggableCancel:".undraggable",margin:[16,16],isBounded:!0,onLayoutChange:function(t){s&&(e({type:"LAYOUTS_CHANGE",payload:t}),x({name:s,workBookId:n,reportId:r,elements:JSON.stringify(c),layouts:JSON.stringify(t)}).then((function(e){})))}},Object.values(c).map((function(e){return o.a.createElement("div",{key:e.id,className:"db_detail_content-wrapper",style:{outline:d===e.id?"1px dashed #1890ff":"none"}},o.a.createElement(oe,{key:e.id,data:e}))}))))},le=n("GiPQ");function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return be(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var pe=function(e){var t=e.dataItem,n=(e.getData,fe(Object(le.a)({item:{type:"drop",data:ue({},t)}}),2)[1]);return o.a.createElement("div",{ref:n,className:"db_detail_dragitem"},o.a.createElement("span",{className:"db_detail_dragitem-dimIden"},"ABC"),t.alias)},me=function(e){var t=e.list;return o.a.createElement("div",{className:"db_detail_dimension"},o.a.createElement("span",{className:"db_detail_dimension-name"},"维度"),o.a.createElement("div",{className:"db_detail_dimension-content"},t.map((function(e,t){return o.a.createElement(pe,{key:t,dataItem:e,getData:"dimemsion"})}))))};function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ge(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Oe=function(e){var t=e.dataItem,n=(e.getData,_e(Object(le.a)({item:{type:"drop",data:he({},t)}}),2)[1]);return o.a.createElement("div",{ref:n,className:"db_detail_dragitem"},o.a.createElement("span",{className:"db_detail_dragitem-meaIden"},"123"),t.name)},Ee=function(e){var t=e.list;return o.a.createElement("div",{className:"db_detail_measures"},o.a.createElement("span",{className:"db_detail_measures-name"},"度量"),o.a.createElement("div",{className:"db_detail_measures-content"},t.map((function(e,t){return o.a.createElement(Oe,{key:t,dataItem:e,getData:"measures"})}))))},we=function(e){var t=Object(i.c)((function(e){return e})).dataSetCubeName;return o.a.createElement("div",{className:"db_detail_dataset"},o.a.createElement("span",{className:"db_detail_dataset-name"},"数据集"),o.a.createElement("div",{className:"db_detail_dataset-dataname"},t))},je=n("ZpHr"),Se=n("EOO0"),xe=n("iczh"),ke=n.n(xe);function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var De=function(e){var t=Object(a.useRef)(null),n=e.item,r=e.dataDisdel,i=e.itemIndex,c=e.moveCard,l=e.hoverIndex,d=e.setHoverItem,u=e.changeName,s=Pe(Object(le.a)({item:{type:"card",index:i},end:function(e){d(null)}}),2)[1],f=Pe(Object(je.a)({accept:["card"],drop:function(e,n){t.current&&(c(e,i),d(null))},collect:function(e){return{isOver:e.isOver()}},hover:function(e,n){t.current&&d(i)}}),2);f[0].isOver;return s((0,f[1])(t)),o.a.createElement("div",{ref:t,className:ke()(n.function?"db_detail_datadisplay-mitem":"db_detail_datadisplay-ditem",l==i?"db_detail_datadisplay-hovBor":"db_detail_datadisplay-nohovBor")},o.a.createElement(V.a,{onChange:function(e){return u(e.target.value,i)},className:n.function?"db_detail_datadisplay-mspan":"db_detail_datadisplay-dspan",value:n.function?n.name:n.alias}),o.a.createElement(Se.a,{className:"db_detail_datadisplay-icon",onClick:function(){return r(i)}}))},Te=function(e){var t=e.onDrop,n=e.list,r=e.updateList,i=Pe(Object(a.useState)(null),2),c=i[0],l=i[1],d=Pe(Object(je.a)({accept:"drop",drop:function(e,n){t&&t(e,"dataDisplay")}}),2),u=d[0],s=(u.isOver,u.isOverCurrent,d[1]);return o.a.createElement("div",{className:"db_detail_datadisplay"},o.a.createElement("span",{className:"db_detail_datadisplay-name"},"数据展示"),o.a.createElement("div",{className:"db_detail_datadisplay-wrap",ref:s},n.map((function(e,t){return o.a.createElement(De,{item:e,key:t,itemIndex:t,hoverIndex:c,dataDisdel:function(e){return function(e){var t=Object(b.a)(n);t.splice(e,1);var a=t.map((function(e,t){return Ne(Ne({},e),{},{sortId:t,columnName:"column"+t})}));r(a)}(e)},setHoverItem:function(e){return l(e)},moveCard:function(e,t){return function(e,t){var a=Object(b.a)(n),o=a[e.index];a.splice(e.index,1),a.splice(t,0,o);var i=a.map((function(e,t){return Ne(Ne({},e),{},{sortId:t,columnName:"column"+t})}));r(i)}(e,t)},changeName:function(e,t){return function(e,t){var a=Object(b.a)(n);a[t].function?a[t].name=e:a[t].alias=e,r(a)}(e,t)}})}))))},Me=n("f6jj"),Be=n("2MTg"),Fe=[{label:"基础筛选",value:1},{label:"高级筛选",value:2}],Le=[{label:"包含",value:"containOperatorStrategy"},{label:"范围",value:"betweenOperatorStrategy"}],Ue={containOperatorStrategy:"包含",betweenOperatorStrategy:"范围"};function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return He(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Je=Be.a.Option,We=function(e){var t=e.item,n=e.updateItem,r=Object(i.c)((function(e){return e})).dataSetId,c=ze(Object(a.useState)(void 0),2),l=c[0],d=c[1],u=ze(Object(a.useState)(void 0),2),s=u[0],f=u[1],p=ze(Object(a.useState)([]),2),m=p[0],y=p[1],h=ze(Object(a.useState)(""),2),v=(h[0],h[1]),g=ze(Object(a.useState)(""),2),O=g[0],w=g[1],j=ze(Object(a.useState)(""),2),S=j[0],x=j[1];Object(a.useEffect)((function(){t.operator&&("="==t.operator||"in"==t.operator?d(1):(d(2),"like"==t.operator?(f("containOperatorStrategy"),w(t.value)):(f("betweenOperatorStrategy"),w(t.value?JSON.parse(t.value)[0]:""),x(t.value?JSON.parse(t.value)[1]:"")))),k("")}),[t]);var k=function(e){var n;(n={dataSetId:r,tableName:t.tableName,field:t.field,fieldType:t.fieldType,keyWord:e},_("/bi-gateway/das/report/filter/queryFieldValue",E({},n)).then((function(e){return e})).catch((function(e){return e}))).then((function(e){e.success&&y(e.data),console.log(e)}))};return o.a.createElement("div",{className:"db_detail_filterItem"},o.a.createElement(Be.a,{onChange:function(e){return function(e){d(e)}(e)},value:l,placeholder:"请选择",className:"db_detail_filterItem-type"},Fe.map((function(e,t){return o.a.createElement(Je,{key:t,value:e.value},e.label)}))),"1"==l&&o.a.createElement(V.a,{className:"db_detail_filterItem-search",placeholder:"搜索",onChange:function(e){return function(e){v(e),k(e)}(e.target.value)}}),"1"==l&&o.a.createElement("div",{className:"db_detail_filterItem-checkGroup"},o.a.createElement(Me.a.Group,{value:t.value?JSON.parse(t.value):[],onChange:function(e){return function(e){var r=Object(b.a)(t);r.value=JSON.stringify(e),r.operator="in",n(r)}(e)}},m.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement(Me.a,{value:e},e))})))),"2"==l&&o.a.createElement(Be.a,{value:s,placeholder:"请选择",className:"db_detail_filterItem-type",onChange:function(e){return function(e){f(e);var r=Object(b.a)(t);"containOperatorStrategy"==e?(r.operator="like",r.value=""):(r.operator="between",r.value=""),n(r)}(e)}},Le.map((function(e,t){return o.a.createElement(Je,{key:t,value:e.value},e.label)}))),"2"==l&&s&&o.a.createElement(V.a,{value:O,className:"db_detail_filterItem-search",onChange:function(e){return function(e){w(e);var r=Object(b.a)(t);r.value="betweenOperatorStrategy"==s?JSON.stringify([e,S]):e,n(r)}(e.target.value)},placeholder:Ue[s]}),"2"==l&&"betweenOperatorStrategy"==s&&o.a.createElement(V.a,{value:S,className:"db_detail_filterItem-search",onChange:function(e){return function(e){x(e);var r=Object(b.a)(t);r.value=JSON.stringify([O,e]),n(r)}(e.target.value)},placeholder:Ue[s]}))};function Ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Re=function(e){var t=e.onDrop,n=e.list,r=e.updateListScr,a=Ve(Object(je.a)({accept:"drop",drop:function(e,n){t&&t(e,"screen")},hover:function(e,t){}}),2),i=a[0],c=(i.isOver,i.isOverCurrent,a[1]);return o.a.createElement("div",{ref:c,className:"db_detail_screen"},o.a.createElement("span",{className:"db_detail_screen-name"},"筛选器"),o.a.createElement("div",{className:"db_detail_screen-content"},o.a.createElement("div",{className:"db_detail_screen-contentWrap"},n.map((function(e,t){return o.a.createElement("div",{key:t,className:"db_detail_screen-screenItem"},o.a.createElement("span",{className:"db_detail_screen-screenName"},e.alias),o.a.createElement(Se.a,{onClick:function(){return function(e){var t=Object(b.a)(n);t.splice(e,1),r(t)}(t)},className:"db_detail_screen-screenClose"}),o.a.createElement(We,{item:e,itemIndex:t,updateItem:function(e){return function(e,t){var a=Object(b.a)(n);a[t]=e,r(a)}(e,t)}}))})))))},Ge=n("PRKH"),$e=n("RgsT");function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){Ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var et=function(){var e=Object(u.h)(),t=e.workbookId,n=e.dashboardId,r=Object(i.c)((function(e){return e})),c=r.elements,l=r.name,d=r.layouts,s=r.selectId,f=r.dataSetId,p=Object(i.b)(),m=Qe(Object(a.useState)([]),2),y=m[0],h=m[1],v=Qe(Object(a.useState)([]),2),g=v[0],O=v[1],w=Qe(Object(a.useState)(null),2),j=(w[0],w[1],Qe(Object(a.useState)([]),2)),S=j[0],k=j[1],I=Qe(Object(a.useState)([]),2),N=I[0],A=I[1];Object(a.useEffect)((function(){P()}),[f]),Object(a.useEffect)((function(){if(s&&c[s]){var e=Object(b.a)(c[s]),t=e.dimensions,n=void 0===t?[]:t,r=e.measures,a=void 0===r?[]:r,o=e.filters,i=void 0===o?[]:o,l=n.concat(a).sort((function(e,t){return e.sortId-t.sortId}));h(l),O(i)}else h([]),O([])}),[s]);var P=function(){var e;(e={setId:f},_("/bi-gateway/das/dataSet/queryDimensionMeasure",E({},e)).then((function(e){return e})).catch((function(e){return e}))).then((function(e){e.success&&(k(e.data.dimensions),A(e.data.measures))})).catch((function(e){console.log(e)}))},D=function(e,t){if(!s)return C.b.warning("请先选中元素"),!1;if("dataDisplay"==t){var n=[Xe({},e.data)].concat(y).map((function(e,t){return Xe(Xe({},e),{},{sortId:t,columnName:"column"+t})}));T(n,g),h(n)}else{if(e.data.function)return C.b.warning("度量不允许拖到筛选器区域"),!1;var r=[e.data],a=Object(b.a)(g).concat(r);O(a),T(y,a)}},T=function(e,r){var a=e.filter((function(e){return!e.function})),o=e.filter((function(e){return e.function})),i=Xe(Xe({},c[s]),{},{dimensions:a,measures:o,filters:r}),u=Object(b.a)(c);u[s]=i,p({type:"INIT_STATE",payload:{name:l,layouts:d,elements:u}}),x({name:l,layouts:JSON.stringify(d),elements:JSON.stringify(u),workBookId:t,reportId:n}).then((function(e){}))};return o.a.createElement($e.a,{backend:Ge.a},o.a.createElement("aside",{className:"db_detail_sider"},o.a.createElement("div",{className:"db_detail_sider-left"},o.a.createElement(we,null),o.a.createElement(me,{list:S}),o.a.createElement(Ee,{list:N})),o.a.createElement("div",{className:"db_detail_sider-right"},o.a.createElement(Te,{onDrop:function(e,t){return D(e,t)},list:y,updateList:function(e){return function(e){h(e),T(e,g)}(e)}}),o.a.createElement(Re,{onDrop:function(e,t){return D(e,t)},list:g,updateListScr:function(e){return function(e){O(e),T(y,e)}(e)}}))))},tt=(n("V/OC"),function(){return o.a.createElement("div",{className:"db_detail_index"},o.a.createElement(P,null),o.a.createElement("div",{className:"db_detail_index-body"},o.a.createElement(et,null),o.a.createElement("div",{className:"db_detail_index-editor"},o.a.createElement(T,null),o.a.createElement(ce,null))))}),nt=V.a.Search,rt=function(e){var t=e.handleSearch;return o.a.createElement("div",null,o.a.createElement(nt,{placeholder:"请输入工作簿名称",enterButton:"搜索",style:{width:300},onSearch:function(e){return t(e)}}))},at=n("vPY8"),ot=n("2Aq7");function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){lt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var st=Be.a.Option,ft={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:17}}},bt=Object(u.i)((function(e){var t=e.closeModal,n=e.itemData,r=dt(Object(a.useState)(!1),2),c=r[0],l=r[1],d=dt(Object(a.useState)([]),2),u=d[0],s=d[1],f=dt(Object(a.useState)({name:"",dataSetCubeName:""}),2),b=f[0],p=f[1],m=Object(i.b)();Object(a.useEffect)((function(){y(),n&&p({name:n.name,dataSetCubeName:n.dataSetCubeName})}),[]);var y=function(){var e;l(!0),(e={},_("/bi-gateway/das/dataSet/queryCubeList",E({},e)).then((function(e){return e})).catch((function(e){return e}))).then((function(e){l(!1),e.success&&s(e.data)})).catch((function(e){console.log(e)}))},h=function(){if(!b.name)return C.b.warning("请填写工作簿名称"),!1;if(!b.dataSetCubeName)return C.b.warning("请选择数据集"),!1;var r=ct(n?{id:n.workBookId}:{},b);m({type:"SAVE_DATASET_CUBE_NAME",payload:b.dataSetCubeName}),l(!0),function(e){return g("/bi-gateway/das/workbook/save",E({},e)).then((function(e){return e})).catch((function(e){return e}))}(r).then((function(n){if(l(!1),n.success){t();var r=n.data.workBookId;m({type:"DATASET_ID_CHANGE",payload:n.data.dataSetId}),e.history.push("/dashboard/detail/".concat(r))}}))};return o.a.createElement(W.a,{visible:!0,title:"新建工作簿",okText:"下一步",onCancel:function(){return t()},onOk:function(){return h()}},o.a.createElement("div",null,o.a.createElement(ot.a,ft,o.a.createElement(ot.a.Item,{label:"工作簿名称",required:!0},o.a.createElement(V.a,{value:b.name,onChange:function(e){return function(e){p(ct(ct({},b),{},{name:e}))}(e.target.value)},placeholder:"请输入",maxLength:20})),o.a.createElement(ot.a.Item,{label:"选择数据集",required:!0},o.a.createElement(Be.a,{disabled:n.workBookId,value:b.dataSetCubeName,placeholder:"请选择",onChange:function(e){return function(e){p(ct(ct({},b),{},{dataSetCubeName:e}))}(e)}},u.map((function(e,t){return o.a.createElement(st,{key:t,value:e},e)})))))),c&&o.a.createElement(k,null))}));function pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yt=function(e){var t=e.updataList,n=pt(Object(a.useState)(!1),2),r=n[0],i=n[1],c=pt(Object(a.useState)({}),2),l=c[0],d=c[1],u=function(e){W.a.confirm({title:"是否删除",content:"确认删除后，数据不可修复",onOk:function(){var n;(n={workBookId:e.workBookId},g("/bi-gateway/das/workbook/delete",E({},n)).then((function(e){return e})).catch((function(e){return e}))).then((function(e){e.success?(t(),C.b.success("删除成功")):C.b.warning(e.message)})).catch((function(e){return console.log(e)}))}})},s=[{title:"工作簿名称",key:"name",dataIndex:"name",render:function(e,t){return o.a.createElement("span",null,e)}},{title:"发布人",key:"owner",dataIndex:"owner"},{title:"操作",key:"action",dataIndex:"action",width:200,render:function(e,t){return o.a.createElement("span",null,o.a.createElement("span",{className:"db_workbook_table-edit",onClick:function(){return d(t),void i(!0)}},"编辑"),o.a.createElement("span",{onClick:function(){return u(t)},className:"db_workbook_table-del"},"删除"))}}];return o.a.createElement("div",null,o.a.createElement(at.a,{onClick:function(){return i(!0)},className:"db_workbook_table-btn",type:"primary"},"新建工作簿"),o.a.createElement(B.a,{columns:s,dataSource:e.data,rowKey:function(e){return e.workBookId}}),r&&o.a.createElement(bt,{itemData:l,closeModal:function(){i(!1)}}))};n("4/dB");function ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _t=function(){var e=ht(Object(a.useState)([]),2),t=e[0],n=e[1],r=ht(Object(a.useState)(""),2),i=r[0],c=r[1],l=ht(Object(a.useState)(!1),2),d=l[0],u=l[1];Object(a.useEffect)((function(){s()}),[i]);var s=function(){var e;u(!0),(e={keyWordQUERY:i},_("/bi-gateway/das/workbook/queryList",E({},e)).then((function(e){return e})).catch((function(e){return e}))).then((function(e){u(!1),e.success&&n(e.data)})).catch((function(e){console.log(e)}))};return o.a.createElement("div",{className:"db_workbook_index"},o.a.createElement("div",{className:"db_workbook_index-header"},"工作簿"),o.a.createElement("div",{className:"db_workbook_search"},o.a.createElement(rt,{handleSearch:function(e){return c(e)}})),o.a.createElement("div",{className:"db_workbook_table"},o.a.createElement(yt,{data:t,updataList:function(){s()}})),d&&o.a.createElement(k,null))},gt=Object(u.i)((function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.d,null,o.a.createElement(u.a,{from:"/",exact:!0,to:"/dashboard/workbook"}),o.a.createElement(u.b,{path:"/dashboard/workbook",component:_t}),o.a.createElement(u.b,{path:"/dashboard/detail/:workbookId/:dashboardId?",component:tt})))})),Ot=function(){return o.a.createElement("div",{className:"db_main_nav"},o.a.createElement("div",{className:"db_main_nav_content"},o.a.createElement(L.a,{defaultSelectedKeys:["/dashboard/workbook"],className:"db_main_nav_content_list"},o.a.createElement(L.a.Item,{key:"/dashboard/workbook"},o.a.createElement(c.b,{to:"/dashboard/workbook"},"工作簿")))))},Et=function(){return o.a.createElement("div",{className:"db_header"},"SHINEMO BI")},wt=Object(u.i)((function(e){var t=e.location.pathname.split("/");return o.a.createElement("div",{className:"db_app"},o.a.createElement(Et,null),!t.some((function(e){return"detail"===e}))&&o.a.createElement(Ot,null),o.a.createElement("div",{className:ke()("db_app_DashBoard-wrap")},o.a.createElement(gt,null)))})),jt=n("b+xT"),St=n("5KVU");function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){It(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Nt,At={name:"",dataSet:void 0,elements:{},layouts:[]},Pt=Object(jt.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ELEMENT":return Object(St.a)(e,(function(e){j(e,t.payload)}));case"DELETE_ELEMENT":return Object(St.a)(e,(function(e){e.selectId===t.payload&&(e.selectId=void 0),S(e,t.payload)}));case"SELECT_ELEMENT":return kt(kt({},e),{},{selectId:t.payload});case"LAYOUTS_CHANGE":return kt(kt({},e),{},{layouts:t.payload});case"ELEMENTS_CHANGE":return kt(kt({},e),{},{elements:t.payload});case"CANVAS_MOUSE_DOWN":return kt(kt({},e),{},{selectId:void 0});case"SAVE_DATASET_CUBE_NAME":return kt(kt({},e),{},{dataSetCubeName:t.payload});case"DATASET_ID_CHANGE":return kt(kt({},e),{},{dataSetId:t.payload});case"INIT_STATE":return kt(kt({},e),{},{name:t.payload.name,elements:t.payload.elements,layouts:t.payload.layouts});default:return e}}));Nt=wt,Object(d.render)(o.a.createElement(r.a,{locale:l.a},o.a.createElement(i.a,{store:Pt},o.a.createElement(c.a,null,o.a.createElement(Nt,null)))),document.getElementById("root"))},"94H+":function(e,t,n){var r=n("+5m6"),a=n("YlNr");"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:"head",singleton:!1};r(a,o);e.exports=a.locals||{}},C9i2:function(e,t,n){"use strict";n.r(t);var r=n("y8BH"),a=n.n(r)()(!1);a.push([e.i,"/* stylelint-disable at-rule-empty-line-before,at-rule-name-space-after,at-rule-no-unknown */\n/* stylelint-disable no-duplicate-selectors */\n/* stylelint-disable */\n/* stylelint-disable declaration-bang-space-before,no-duplicate-selectors,string-no-newline */\n.db_detail_index-body {\n  display: flex;\n}\n.db_detail_index-editor {\n  flex-grow: 1;\n}\n.db_detail_header {\n  border-bottom: solid 1px #d9d9d9;\n}\n.db_detail_header-main {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 48px;\n  padding: 0 8px;\n  border-bottom: solid 1px #d9d9d9;\n}\n.db_detail_header-title {\n  margin-left: 4px;\n  font-size: 16px;\n  font-weight: 700;\n}\n.db_detail_header .ant-tabs-nav {\n  margin: 0;\n}\n.db_detail_toolbar {\n  display: flex;\n  align-items: center;\n  height: 32px;\n  padding: 0 8px;\n}\n.db_detail_toolbar-icon {\n  padding: 0 4px;\n  font-size: 20px;\n}\n.db_detail_sider {\n  display: flex;\n  flex-shrink: 0;\n  border-right: solid 1px #d9d9d9;\n  background: #fff;\n}\n.db_detail_sider-left {\n  width: 210px;\n  border-right: solid 1px #d9d9d9;\n}\n.db_detail_sider-right {\n  width: 210px;\n}\n.db_detail_content {\n  height: calc(100vh - 170px);\n  background-color: #ededed;\n  overflow: auto;\n}\n.db_detail_content-wrapper {\n  padding: 10px;\n  background: #fff;\n  overflow: hidden;\n}\n.db_detail_container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.db_detail_container-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 12px;\n  margin-bottom: 8px;\n}\n.db_detail_container-more {\n  padding: 0 4px;\n  color: rgba(0, 0, 0, 0.45);\n  cursor: pointer;\n}\n.db_detail_container-content {\n  flex-grow: 1;\n  cursor: move;\n  overflow: auto;\n}\n.db_detail_dataset {\n  padding: 15px 0 30px 0;\n  border-bottom: 1px solid #EAECED;\n}\n.db_detail_dataset-name {\n  font-size: 16px;\n  color: #1D223E;\n  margin-left: 25px;\n}\n.db_detail_dataset-dataname {\n  font-size: 14px;\n  color: #5C626B;\n  background-color: #F7F8F9;\n  line-height: 30px;\n  margin-top: 15px;\n  padding: 0 25px;\n}\n.db_detail_dimension,\n.db_detail_datadisplay {\n  padding: 15px 25px 20px 25px;\n  border-bottom: 1px solid #EAECED;\n}\n.db_detail_dimension-name,\n.db_detail_datadisplay-name {\n  font-size: 16px;\n  color: #1D223E;\n}\n.db_detail_dimension-content,\n.db_detail_datadisplay-content {\n  margin-top: 15px;\n  height: 210px;\n  overflow: auto;\n}\n.db_detail_dimension-item,\n.db_detail_datadisplay-item {\n  font-size: 14px;\n  color: #262A30;\n  line-height: 28px;\n}\n.db_detail_dimension-ditem,\n.db_detail_datadisplay-ditem {\n  background-color: #FFF2DC;\n  border-radius: 13px;\n  width: 160px;\n  margin-bottom: 5px;\n  border: none;\n  height: 26px;\n}\n.db_detail_dimension-hovBor,\n.db_detail_datadisplay-hovBor {\n  border-bottom: 2px solid #488FF9;\n}\n.db_detail_dimension-nohovBor,\n.db_detail_datadisplay-nohovBor {\n  border-bottom: none;\n}\n.db_detail_dimension-dspan,\n.db_detail_datadisplay-dspan {\n  display: inline-block;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  width: 120px;\n  margin-left: 14px;\n  font-size: 14px;\n  color: #F4A022;\n  line-height: 26px;\n  border: none;\n  height: 26px;\n  background-color: rgba(255, 255, 255, 0);\n}\n.db_detail_dimension-icon,\n.db_detail_datadisplay-icon {\n  vertical-align: top;\n  margin-top: 7px;\n  cursor: pointer;\n  color: #ffffff;\n  opacity: 0;\n}\n.db_detail_dimension-ditem:hover,\n.db_detail_datadisplay-ditem:hover {\n  background-color: #F4A022;\n}\n.db_detail_dimension-ditem:hover .db_detail_datadisplay-dspan,\n.db_detail_datadisplay-ditem:hover .db_detail_datadisplay-dspan {\n  color: #ffffff;\n}\n.db_detail_dimension-ditem:hover .db_detail_datadisplay-icon,\n.db_detail_datadisplay-ditem:hover .db_detail_datadisplay-icon {\n  opacity: 1;\n}\n.db_detail_dimension .db_detail_datadisplay-dspan:focus,\n.db_detail_datadisplay .db_detail_datadisplay-dspan:focus {\n  border: none;\n  box-shadow: none;\n}\n.db_detail_dimension .db_detail_datadisplay-mspan:focus,\n.db_detail_datadisplay .db_detail_datadisplay-mspan:focus {\n  border: none;\n  box-shadow: none;\n}\n.db_detail_dimension-mitem,\n.db_detail_datadisplay-mitem {\n  background-color: #E0F7ED;\n  width: 160px;\n  border-radius: 13px;\n  height: 26px;\n  margin-bottom: 5px;\n}\n.db_detail_dimension-mspan,\n.db_detail_datadisplay-mspan {\n  display: inline-block;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  width: 120px;\n  margin-left: 14px;\n  font-size: 14px;\n  color: #23C172;\n  line-height: 26px;\n  height: 26px;\n  border: none;\n  background-color: rgba(255, 255, 255, 0);\n}\n.db_detail_dimension-mitem:hover,\n.db_detail_datadisplay-mitem:hover {\n  background-color: #23C172;\n}\n.db_detail_dimension-mitem:hover .db_detail_datadisplay-icon,\n.db_detail_datadisplay-mitem:hover .db_detail_datadisplay-icon {\n  opacity: 1;\n}\n.db_detail_dimension-mitem:hover .db_detail_datadisplay-mspan,\n.db_detail_datadisplay-mitem:hover .db_detail_datadisplay-mspan {\n  color: #ffffff;\n}\n.db_detail_dimension-wrap,\n.db_detail_datadisplay-wrap {\n  margin-top: 15px;\n  height: 210px;\n  overflow: auto;\n  min-height: 100px;\n  border: 1px dashed #ccc;\n  padding-top: 6px;\n}\n.db_detail_measures,\n.db_detail_screen {\n  padding: 15px 10px 20px 25px;\n  overflow: hidden;\n  position: relative;\n}\n.db_detail_measures-name,\n.db_detail_screen-name {\n  font-size: 16px;\n  color: #1D223E;\n}\n.db_detail_measures-content,\n.db_detail_screen-content {\n  margin-top: 15px;\n  overflow: auto;\n  height: 100%;\n  box-sizing: border-box;\n}\n.db_detail_measures-contentWrap,\n.db_detail_screen-contentWrap {\n  width: 160px;\n  border: 1px dashed #ccc;\n  height: 100%;\n}\n.db_detail_measures-item,\n.db_detail_screen-item {\n  font-size: 14px;\n  color: #262A30;\n  line-height: 28px;\n}\n.db_detail_measures-screenItem,\n.db_detail_screen-screenItem {\n  background-color: #E9ECF0;\n  border-radius: 4px;\n  border: 1px solid #E9ECF0;\n  margin-bottom: 10px;\n  padding: 15px 0;\n}\n.db_detail_measures-screenName,\n.db_detail_screen-screenName {\n  color: #262A30;\n  font-size: 14px;\n  display: inline-block;\n  margin: 0px 0px 10px 10px;\n}\n.db_detail_measures-screenClose,\n.db_detail_screen-screenClose {\n  font-size: 12px;\n  cursor: pointer;\n}\n.db_detail_dragitem {\n  font-size: 14px;\n  color: #262A30;\n  line-height: 28px;\n  cursor: move;\n}\n.db_detail_dragitem-meaIden {\n  color: #2DC888;\n  font-size: 12px;\n  margin-right: 3px;\n}\n.db_detail_dragitem-dimIden {\n  color: #FFA400;\n  font-size: 12px;\n  margin-right: 3px;\n}\n.db_detail_filterItem-type {\n  width: 140px;\n  margin-left: 6px;\n  margin-bottom: 10px;\n}\n.db_detail_filterItem-search {\n  width: 140px;\n  margin-bottom: 10px;\n  margin-left: 6px;\n}\n.db_detail_filterItem-checkGroup {\n  padding: 0 8px;\n  max-height: 112px;\n  overflow: auto;\n}\n.db_detail_filterItem-checkGroup .ant-checkbox-group :global .ant-checkbox-wrapper {\n  margin-left: 0;\n}\n.db_detail_measures-content {\n  height: calc(100vh - 600px);\n}\n.db_detail_screen-content {\n  height: calc(100vh - 488px);\n}\n",""]),t.default=a},"V/OC":function(e,t,n){var r=n("+5m6"),a=n("C9i2");"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:"head",singleton:!1};r(a,o);e.exports=a.locals||{}},YlNr:function(e,t,n){"use strict";n.r(t);var r=n("y8BH"),a=n.n(r)()(!1);a.push([e.i,"body {\n  overflow: hidden;\n}\n.db_header {\n  height: 48px;\n  line-height: 48px;\n  background: linear-gradient(180deg, #3d424a, #262a30);\n  padding: 0 16px;\n  color: #fff;\n  min-width: 1200px;\n}\n.db_main_nav {\n  float: left;\n  height: 100%;\n}\n.db_main_nav_content {\n  width: 200px;\n  height: 100%;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  background-color: #fff;\n  box-sizing: border-box;\n  box-shadow: 0 0 4px rgba(0, 0, 0, 0.08);\n}\n.db_main_nav_content_list {\n  overflow: hidden;\n  overflow-y: auto;\n}\n.db_app {\n  height: 100%;\n}\n.db_app_DashBoard-wrap {\n  width: auto;\n  height: 100%;\n  overflow: hidden;\n}\n.db_app_DashBoard-left {\n  padding-left: 200px;\n}\n",""]),t.default=a},fa4X:function(e,t,n){"use strict";n.r(t);var r=n("y8BH"),a=n.n(r)()(!1);a.push([e.i,".db_common_loading {\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 48px;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0);\n  z-index: 99;\n}\n.db_common_loading-wrap {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.db_common_loading-wrap img {\n  width: 100px;\n}\n",""]),t.default=a},r4t0:function(e,t,n){var r=n("+5m6"),a=n("fa4X");"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:"head",singleton:!1};r(a,o);e.exports=a.locals||{}},ryuo:function(e,t,n){"use strict";n.r(t);var r=n("y8BH"),a=n.n(r)()(!1);a.push([e.i,".db_workbook {\n  background-color: #F7F9FA;\n}\n.db_workbook_index-header {\n  padding: 25px 0px 24px 25px;\n  font-size: 18px;\n  font-weight: 500;\n  color: #1D223E;\n}\n.db_workbook_table {\n  margin: 25px 25px;\n  padding: 16px;\n  background: #FFFFFF;\n  box-shadow: 0px 0px 6px 0px rgba(0, 0, 0, 0.08);\n  border-radius: 2px;\n}\n.db_workbook_table-watch {\n  color: #488FF9;\n  margin-right: 20px;\n  cursor: pointer;\n}\n.db_workbook_table-del {\n  color: #488FF9;\n  cursor: pointer;\n}\n.db_workbook_table-edit {\n  color: #488FF9;\n  margin-right: 20px;\n  cursor: pointer;\n}\n.db_workbook_table-btn {\n  margin-bottom: 16px;\n}\n.db_workbook_search {\n  padding-left: 25px;\n}\n",""]),t.default=a}});